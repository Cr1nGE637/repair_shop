{% extends 'base.html' %}

{% block title %}Склад компонентов - Ремонтная мастерская{% endblock %}

{% block content %}
<h1>Склад компонентов</h1>

<form method="get" class="search-form">
    <input type="text" name="search" placeholder="Поиск по названию, артикулу, поставщику..." value="{{ search_query }}">
    <label>
        <input type="checkbox" name="low_stock" value="1" {% if low_stock %}checked{% endif %}>
        Только с низким остатком (< 5)
    </label>
    <button type="submit" class="btn">Поиск</button>
    <a href="{% url 'repair:component_list' %}" class="btn">Сбросить</a>
</form>

{% if components %}
<table>
    <thead>
        <tr>
            <th>Название</th>
            <th>Артикул</th>
            <th>Количество</th>
            <th>Цена за единицу</th>
            <th>Поставщик</th>
            <th>Статус</th>
            <th>Действия</th>
        </tr>
    </thead>
    <tbody>
        {% for component in components %}
        <tr>
            <td>{{ component.name }}</td>
            <td>{{ component.part_number|default:"—" }}</td>
            <td>{{ component.quantity }}</td>
            <td>{{ component.unit_price }} руб.</td>
            <td>{{ component.supplier|default:"—" }}</td>
            <td>
                {% if component.quantity > 0 %}
                <span style="color: green;">✓ В наличии</span>
                {% else %}
                <span style="color: red;">✗ Нет в наличии</span>
                {% endif %}
            </td>
            <td>
                <a href="/admin/repair/component/{{ component.id }}/change/" class="btn">Редактировать</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<p>Компоненты не найдены.</p>
{% endif %}

<div style="margin-top: 1rem;">
    <a href="/admin/repair/component/add/" class="btn">➕ Добавить компонент</a>
</div>
{% endblock %}

